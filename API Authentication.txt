

Cypress.Commands.add('loginViaAPI', () => {
  const email = Cypress.env('userEmail');
  const password = Cypress.env('userPassword');

  cy.request('POST', `${Cypress.env('apiUrl')}/users/login`, {
    username: email,
    password: password,
  }).then((response) => {
    // Set cookies or perform other actions based on API response
    cy.setCookie('sessionId', response.body.sessionId);
    cy.setCookie('userId', response.body.userId);
    cy.setCookie('userName', response.body.userName);

    // Visit the desired page after successful login
    cy.visit('/#!/main');
  });
});



// contoh penggunaan di suatu skenario pengujian
describe('Test Login via API', () => {
  it('should login successfully', () => {
    cy.loginViaAPI();
  });
});
